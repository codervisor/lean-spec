#!/bin/sh
# Run full validation before pushing

echo "ğŸ” Running Node.js/TypeScript checks..."

echo "  â†’ TypeScript typecheck..."
pnpm typecheck
if [ $? -ne 0 ]; then
  echo "âŒ TypeScript typecheck failed! Fix the errors before pushing."
  exit 1
fi

echo "  â†’ Running tests..."
pnpm test
if [ $? -ne 0 ]; then
  echo "âŒ Node.js tests failed! Fix the failing tests before pushing."
  exit 1
fi

echo "âœ… Node.js/TypeScript checks passed!"

echo ""
echo "ğŸ¦€ Running Rust checks..."

echo "  â†’ Clippy lints..."
cargo clippy --manifest-path rust/Cargo.toml -- -D warnings
if [ $? -ne 0 ]; then
  echo "âŒ Clippy checks failed! Fix the warnings before pushing."
  exit 1
fi

echo "âœ… Rust checks passed!"

echo ""
echo "ğŸ‰ All pre-push checks passed!"
